#!/bin/bash

# run_once_install-packages.sh.tmpl
# This script runs once when chezmoi apply is first executed

set -e

# Colors
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
NC='\033[0m'

echo -e "${YELLOW}Installing packages and setting up environment...${NC}"

# Update system and install packages
sudo pacman -Syu --needed --noconfirm which unzip base-devel git zsh starship go direnv fzf fd ripgrep eza procs navi vivid neovim

# Install AUR helper (yay)
if ! command -v yay &> /dev/null; then
    echo -e "${YELLOW}Installing AUR helper (yay)...${NC}"
    git clone https://aur.archlinux.org/yay.git /tmp/yay
    (cd /tmp/yay && makepkg -si --noconfirm)
    rm -rf /tmp/yay
    echo -e "${GREEN}yay installed successfully.${NC}"
fi

echo -e "${GREEN}Setting ZSH as default shell...${NC}"
if [ "$SHELL" != "$(which zsh)" ]; then
    chsh -s $(which zsh)
fi

echo -e "${GREEN}Bootstrap complete! Restart your shell to use ZSH.${NC}"
