# SSH completion script

# Function to extract hosts from the SSH config file
_ssh_hosts() {
  local config_file=~/.ssh/config
  if [[ -f $config_file ]]; then
    awk '/^Host / {for (i=2; i<=NF; i++) print $i}' $config_file
  fi
}

# Main completion function for ssh
_ssh_complete() {
  local curcontext="$curcontext" state line
  typeset -A opt_args
  
  _arguments -C \
    '*:ssh host:->ssh_hosts'
  
  case $state in
    ssh_hosts)
      local -a hosts
      hosts=($(_ssh_hosts))
      _describe -t hosts 'ssh hosts' hosts
      ;;
  esac
}

# Bind the completion function to the ssh command
compdef _ssh_complete ssh
